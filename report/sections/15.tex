\section{Question 15}

The transfer function of the discrete time closed-loop system is

\begin{align*}
  H_{cl}(z) &= \dfrac{F(z)\cdot G(z)}{1 + F(z)\cdot G(z)} \\
         &= \dfrac{\dfrac{(c_0z^2 + c_1z +c_2)(a_1z + a_2)}{(z-1)(z+r)(z^2 + b_1z + b_2)}}
            {1 + \dfrac{(c_0z^2 + c_1z +c_2)(a_1z + a_2)}{(z-1)(z+r)(z^2 + b_1z + b_2)}} \\
         &= \dfrac{\dfrac{(c_0z^2 + c_1z +c_2)(a_1z + a_2)}{(z-1)(z+r)(z^2 + b_1z + b_2)}}
            {\dfrac{(z-1)(z+r)(z^2 + b_1z + b_2) + (c_0z^2 + c_1z +c_2)(a_1z + a_2)}{(z-1)(z+r)(z^2 + b_1z + b_2)}}\\
         &= \dfrac{(c_0z^2 + c_1z +c_2)(a_1z + a_2)}{(z-1)(z+r)(z^2 + b_1z + b_2) + (c_0z^2 + c_1z +c_2)(a_1z + a_2)}\\
\end{align*}

The pole polynomial $P_d(z)$ is defined as

\begin{align*}
  P_d(z) = z^4 + d_0z^3 + d_1z^2 + d_2z + d_3
\end{align*}

and is equal to that of equation \ref{eq:14}.

The denominator of $H_{cl}(z)$ and $P_d(z)$ should be equal:

\begin{equation*}
  (z-1)(z+r)(z^2 + b_1z + b_2) + (c_0z^2 + c_1z +c_2)(a_1z + a_2) = z^4 + d_0z^3 + d_1z^2 + d_2z + d_3
\end{equation*}

\begin{align*}
  z^4 &\\
    + (b_1 - 1 + r + c_0a_1)z^3 &\\
    + (b_2 - b_1 -r + rb_1 +c_0a_2 + c_1a_1)z^2 &\\
    + (-b_2 - b_1r + rb_2 + c_1a_2 + c_2a_1)z &\\
    - rb_2 + c_2a_2 &\\
    =  z^4 + d_0z^3 + d_1z^2 + d_2z + d_3\\
\end{align*}

Hence

\begin{align*}
    d_0 &= b_1 - 1 + r + c_0a_1 \\
    d_1 &= b_2 - b_1 -r + rb_1 +c_0a_2 + c_1a_1 \\
    d_2 &= -b_2 - b_1r + rb_2 + c_1a_2 + c_2a_1 \\
    d_3 &= - rb_2 + c_2a_2 \\
\end{align*}

or

\begin{align*}
    d_0 - b_1 + 1   &= r + c_0a_1 \\
    d_1 - b_2 + b_1 &= -r + rb_1 +c_0a_2 + c_1a_1 \\
    d_2 + b_2       &= -b_1r + rb_2 + c_1a_2 + c_2a_1 \\
    d_3             &= - rb_2 + c_2a_2 \\
\end{align*}

or, in matrix form

\begin{equation}
  \begin{bmatrix}
    1         & a_1 & 0   & 0   \\
    b_1 - 1   & a_2 & a_1 & 0   \\
    b_2 - b_1 & 0   & a_2 & a_1 \\
    -b_2      & 0   & 0   & a_2 \\
  \end{bmatrix}
  \begin{bmatrix}
    r   \\
    c_0 \\
    c_1 \\
    c_2 \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    d_0 - b_1 + 1   \\
    d_1 - b_2 + b_1 \\
    d_2 + b_2       \\
    d_3
  \end{bmatrix}
  \label{eq:15}
\end{equation}
